<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klasifikasi Spesies Kopi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loader {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-12 max-w-4xl">
        <div class="bg-white rounded-xl shadow-md overflow-hidden p-8">
            <div class="text-center mb-10">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Klasifikasi Spesies Kopi</h1>
                <p class="text-gray-600">Masukkan karakteristik kopi untuk memprediksi spesiesnya</p>
            </div>

            <form id="predictionForm" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                <!-- Column 1 -->
                <div class="space-y-4">
                    <div>
                        <label for="aroma" class="block text-sm font-medium text-gray-700 mb-1">Aroma</label>
                        <input type="number" id="aroma" name="Aroma" step="0.01" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <div>
                        <label for="flavor" class="block text-sm font-medium text-gray-700 mb-1">Flavor</label>
                        <input type="number" id="flavor" name="Flavor" step="0.01" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <div>
                        <label for="aftertaste" class="block text-sm font-medium text-gray-700 mb-1">Aftertaste</label>
                        <input type="number" id="aftertaste" name="Aftertaste" step="0.01" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <div>
                        <label for="acidity" class="block text-sm font-medium text-gray-700 mb-1">Acidity</label>
                        <input type="number" id="acidity" name="Acidity" step="0.01" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <div>
                        <label for="sweetness" class="block text-sm font-medium text-gray-700 mb-1">Sweetness</label>
                        <input type="number" id="sweetness" name="Sweetness" step="0.01" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>

                </div>


                <div class="md:col-span-2 flex flex-col items-center">
                    <button type="button" onclick="predict()"
                        class="px-6 py-3 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                        Prediksi Spesies Kopi
                    </button>

                    <div class="loader mt-4" id="predictionLoader"></div>
                </div>
            </form>

            <div id="result" class="mt-8 p-4 rounded-md bg-blue-50 text-center hidden">
                <h3 class="text-lg font-medium text-blue-800">Hasil Prediksi</h3>
                <p id="resultText" class="mt-2 text-blue-600"></p>
            </div>
        </div>
    </div>

    <script>
        async function predict() {
            const form = document.getElementById('predictionForm');
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('resultText');
            const loaderDiv = document.getElementById('predictionLoader'); 

            // Reset and show loader
            resultDiv.classList.add('hidden');
            resultText.innerText = ''; 
            loaderDiv.style.display = 'block'; 

            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = parseFloat(value);
            });

            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                
                if (response.ok) {
                    resultText.innerText = result.prediction;
                    resultDiv.classList.remove('hidden');
                } else {
                    resultText.innerText = 'Error: ' + (result.error || 'Terjadi kesalahan saat prediksi');
                    resultDiv.classList.remove('hidden');
                }

            } catch (error) {
                resultText.innerText = 'Error: Terjadi kesalahan saat mengirim permintaan';
                resultDiv.classList.remove('hidden');
                console.error('Fetch error:', error);
            } finally {
                loaderDiv.style.display = 'none';
            }
        }
    </script>
</body>
</html>